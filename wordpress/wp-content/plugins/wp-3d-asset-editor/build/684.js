"use strict";(self.webpackChunkwp_3d_asset_editor=self.webpackChunkwp_3d_asset_editor||[]).push([[684],{35684:function(e,r,t){t.r(r),t.d(r,{default:function(){return d}});var n=t(10467),o=t(47075),u=t(51609),a=t(7616),c=(t(73076),t(10790));function i(){var e,r,t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function u(t,n,o,u){var i=n&&n.prototype instanceof c?n:c,s=Object.create(i.prototype);return l(s,"_invoke",function(t,n,o){var u,c,i,l=0,s=o||[],f=!1,p={p:0,n:0,v:e,a:d,f:d.bind(e,4),d:function(r,t){return u=r,c=0,i=e,p.n=t,a}};function d(t,n){for(c=t,i=n,r=0;!f&&l&&!o&&r<s.length;r++){var o,u=s[r],d=p.p,h=u[2];t>3?(o=h===n)&&(i=u[(c=u[4])?5:(c=3,3)],u[4]=u[5]=e):u[0]<=d&&((o=t<2&&d<u[1])?(c=0,p.v=n,p.n=u[1]):d<h&&(o=t<3||u[0]>n||n>h)&&(u[4]=t,u[5]=n,p.n=h,c=0))}if(o||t>1)return a;throw f=!0,n}return function(o,s,h){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&d(s,h),c=s,i=h;(r=c<2?e:i)||!f;){u||(c?c<3?(c>1&&(p.n=-1),d(c,i)):p.n=i:p.v=i);try{if(l=2,u){if(c||(o="next"),r=u[o]){if(!(r=r.call(u,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,c<2&&(c=0)}else 1===c&&(r=u.return)&&r.call(u),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);u=e}else if((r=(f=p.n<0)?i:t.call(n,p))!==a)break}catch(r){u=e,c=1,i=r}finally{l=1}}return{value:r,done:f}}}(t,o,u),!0),s}var a={};function c(){}function s(){}function f(){}r=Object.getPrototypeOf;var p=[][n]?r(r([][n]())):(l(r={},n,function(){return this}),r),d=f.prototype=c.prototype=Object.create(p);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,l(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=f,l(d,"constructor",f),l(f,"constructor",s),s.displayName="GeneratorFunction",l(f,o,"GeneratorFunction"),l(d),l(d,o,"Generator"),l(d,n,function(){return this}),l(d,"toString",function(){return"[object Generator]"}),(i=function(){return{w:u,m:h}})()}function l(e,r,t,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}l=function(e,r,t,n){function u(r,t){l(e,r,function(e){return this._invoke(r,t,e)})}r?o?o(e,r,{value:t,enumerable:!n,configurable:!n,writable:!n}):e[r]=t:(u("next",0),u("throw",1),u("return",2))},l(e,r,t,n)}var s={lat:0,lng:0},f=111320,p=.1;function d(e){var r=e.modelUrl,t=void 0===r?"":r,l=e.lat,d=void 0===l?0:l,h=e.lng,v=void 0===h?0:h,y=e.yaw,w=void 0===y?0:y,b=e.pitch,g=void 0===b?0:b,m=e.roll,P=void 0===m?0:m,k=(0,u.useRef)(null),E=(0,u.useRef)(null),_=(0,u.useRef)(null),O=(0,u.useRef)(null),R=(0,u.useState)(!1),j=(0,o.A)(R,2),z=(j[0],j[1]),M=(0,u.useState)(""),T=(0,o.A)(M,2),x=(T[0],T[1]);(0,u.useEffect)(function(){if(k.current&&!E.current){var e=new a.N$8(k.current,!0,{alpha:!0,adaptToDeviceRatio:!0});E.current=e;var r=new a.Z58(e);_.current=r,new a.Lqh("camera",-Math.PI/2,Math.PI/2.5,20,a.Pq0.Zero(),r).attachControl(k.current,!0),new a.g4z("light",new a.Pq0(0,1,0),r),a.PeD.CreateGround("ground",{width:200,height:200},r),e.runRenderLoop(function(){return r.render()});var t=function(){return e.resize()};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t),e.stopRenderLoop(),r.dispose(),e.dispose(),E.current=null,_.current=null}}},[]);var C=(0,u.useCallback)(function(e,r,t,n,o){if(O.current){var u=function(e,r){var t=(e-s.lat)*f;return{x:(r-s.lng)*(f*Math.cos(s.lat*Math.PI/180))*p,z:t*p}}(Number(e)||0,Number(r)||0),c=u.x,i=u.z;O.current.position=new a.Pq0(c,0,i);var l=a.PTz.FromEulerAngles(0,t*Math.PI/180,0),d=a.PTz.FromEulerAngles(n*Math.PI/180,0,0),h=a.PTz.FromEulerAngles(0,0,o*Math.PI/180);O.current.rotationQuaternion=l.multiply(d).multiply(h)}},[]),S=(0,u.useCallback)((0,n.A)(i().m(function e(){var r,n,o,u,c,l,s,f,p,h;return i().w(function(e){for(;;)switch(e.p=e.n){case 0:if(_.current){e.n=1;break}return e.a(2);case 1:if(z(!0),x(""),O.current&&(O.current.getChildMeshes().forEach(function(e){return e.dispose()}),O.current.dispose(),O.current=null),e.p=2,r=new a.VR0("assetRoot",_.current),!t){e.n=4;break}return e.n=3,a.cng.ImportMeshAsync(null,t,"",_.current);case 3:n=e.v,(o=n.meshes[0])&&o.setParent(r),u=o.getHierarchyBoundingVectors(),c=u.min,l=u.max,s=l.subtract(c),f=Math.max(s.x,s.y,s.z)||1,p=5/f,r.scaling=new a.Pq0(p,p,p);case 4:O.current=r,C(d,v,w,g,P),e.n=6;break;case 5:e.p=5,h=e.v,console.error(h),x("Failed to load model (check URL and CORS).");case 6:return e.p=6,z(!1),e.f(6);case 7:return e.a(2)}},e,null,[[2,5,6,7]])})),[t,C,d,v,w,g,P]);return(0,u.useEffect)(function(){S()},[S]),(0,u.useEffect)(function(){C(d,v,w,g,P)},[d,v,w,g,P,C]),(0,c.jsx)("canvas",{ref:k,style:{width:"100%",height:"100%"}})}}}]);